# Claude Code 项目指南 (CLAUDE.md)

这是项目的"圣经"文档，为Claude AI提供了关于此项目的完整上下文信息。Claude在参与项目时会自动加载此文档，确保其对项目有全面深入的理解。

## 项目概览

这是一个基于 Next.js 的导航网站项目，是从 Angular 项目迁移而来，具有以下特点：
- 纯静态、支持SEO、在线编辑
- 内置收录多达 800+ 优质网站
- 支持多种部署方式（GitHub Pages、Netlify、Vercel等）
- 无数据库、无服务器、零成本一键部署

项目已初始化并推送至 GitHub 仓库：https://github.com/mmungdong/nav-next

## 迁移参考文档

本项目是基于以下文档进行迁移的：
- NEXTJS_MIGRATION_PLAN.md - 迁移计划文档
- NEXTJS_TECHNICAL_SPEC.md - 技术规格文档

这两个文档详细说明了从 Angular 到 Next.js 的迁移策略、技术选型和实现方案。

## Claude Code 使用指南

### 最佳实践原则

1. **上下文完整性**：此文档包含了项目的所有关键信息，Claude应优先参考本文档而非外部知识
2. **代码质量优先**：所有代码变更都应遵循项目现有模式和最佳实践
3. **渐进式开发**：复杂功能应分解为小的、可验证的步骤
4. **测试驱动**：每次修改后都应验证构建和功能是否正常

### 项目工作流程

1. **理解需求**：仔细阅读用户请求，必要时询问澄清问题
2. **分析影响**：评估变更对现有功能的影响
3. **制定计划**：将任务分解为具体实施步骤
4. **编码实现**：编写符合项目规范的代码
5. **验证测试**：确保修改不会破坏现有功能
6. **文档更新**：必要时更新相关文档

### 主题偏好设置

用户主要使用 **side主题**，因此后续的所有更改和优化都应基于side主题的样式进行实现。在开发过程中需要特别关注：
- 确保修改与side主题的设计风格保持一致
- 验证在side主题下的功能表现和视觉效果
- 如涉及其他主题的修改，需要同时考虑对side主题的影响

### 代码规范

- 遵循项目现有的代码风格和架构模式
- 保持与现有组件的一致性
- 添加适当的注释说明复杂逻辑
- 确保代码的可读性和可维护性

### 代码质量保证

项目使用ESLint进行代码质量检查，确保代码符合规范：

1. **ESLint配置**：
   - 使用TypeScript ESLint解析器
   - 集成import插件管理导入顺序
   - 配置了适合Next.js项目的规则集

2. **可用的脚本命令**：
   ```bash
   # 检查代码质量
   npm run lint

   # 自动修复可修复的问题
   npm run lint:fix

   # 格式化代码
   npm run format
   ```

3. **代码质量要求**：
   - 所有TypeScript文件都应通过ESLint检查
   - 提交代码前应运行`npm run lint:fix`自动修复问题
   - 避免使用`any`类型，应使用具体的类型定义
   - 保持导入语句的正确顺序和格式
   - 遵循单引号、无分号等基本代码风格

### Git 提交规范

项目遵循 Angular 的提交规范（Conventional Commits）：

1. **提交格式**：
   ```
   <type>(<scope>): <subject>

   <body>

   <footer>
   ```

2. **提交类型**：
   - `feat`: 新功能
   - `fix`: 修复bug
   - `docs`: 文档更新
   - `style`: 代码格式调整（不影响代码含义）
   - `refactor`: 代码重构（既不修复bug也不添加功能）
   - `perf`: 性能优化
   - `test`: 测试相关
   - `chore`: 构建过程或辅助工具的变动

3. **示例**：
   ```
   feat(nav): 添加网站分类功能

   fix(auth): 修复登录验证问题

   docs(readme): 更新安装说明
   ```

## 项目架构

### 技术栈

- **框架**: Next.js 14+ (App Router)
- **UI库**: ShadCN UI
- **状态管理**: Zustand
- **构建工具**: Next.js 内置编译器
- **包管理**: pnpm
- **样式**: Tailwind CSS
- **认证授权**: 自定义认证系统 (JWT Token + RBAC权限控制)
- **其他依赖**:
  - axios (HTTP客户端)
  - dayjs (日期处理)
  - localforage (本地存储)

### 项目结构

```
nav-next/
├── public/                 # 静态资源文件
├── src/
│   ├── app/                # Next.js App Router 结构
│   │   ├── layout.tsx      # 根布局
│   │   ├── page.tsx        # 首页
│   │   ├── side/           # Side 主题页面
│   │   │   ├── page.tsx
│   │   │   └── components/ # Side 主题组件
│   │   ├── system/         # 后台管理系统
│   │   │   ├── layout.tsx
│   │   │   ├── page.tsx
│   │   │   └── [module]/   # 各个管理模块
│   │   └── globals.css     # 全局样式
│   ├── components/         # 公共组件
│   ├── lib/                # 工具函数和库
│   ├── stores/             # Zustand 状态管理
│   ├── types/              # TypeScript 类型定义
│   └── data/               # 数据文件
├── next.config.js          # Next.js 配置
├── tsconfig.json           # TypeScript 配置
└── package.json            # 项目依赖
```

### 核心模块

#### 1. 主应用模块 (src/app/)

包含应用的根组件和路由配置：
- `layout.tsx`: 根布局，负责应用的整体布局
- `page.tsx`: 首页，重定向到 /side

#### 2. 视图层 (src/app/)

包含不同的主题页面和管理系统：
- `side/`: 侧边栏主题
- `system/`: 后台管理系统，包括：
  - info: 信息管理
  - bookmark: 书签管理
  - collect: 收录管理
  - auth: 权限管理
  - tag: 标签管理
  - search: 搜索管理
  - setting: 设置管理
  - component: 组件管理
  - web: 网站管理
  - config: 配置管理

#### 3. 组件库 (src/components/)

包含可复用的UI组件，如：
- breadcrumb: 面包屑导航
- calendar: 日历组件
- card: 卡片组件
- create-web: 创建网站组件
- delete-modal: 删除确认模态框
- edit-class: 编辑分类组件
- footer: 页脚组件
- loading: 加载动画
- login: 登录组件

#### 4. 状态管理 (src/stores/)

使用Zustand进行状态管理：
- `navStore`: 导航数据状态
- `settings`: 系统设置
- `search`: 搜索配置
- `tagList`: 标签列表

#### 5. 服务层 (src/lib/)

提供业务逻辑和服务封装：
- `api`: API接口调用
- `utils`: 工具函数

#### 6. 工具函数 (src/lib/utils/)

包含各种辅助函数：
- 路由处理
- 用户认证
- 数据处理
- 设备检测
- 字符串操作

## 配置文件

### next.config.js

Next.js构建配置，定义：
- 构建选项
- 图像优化配置
- 环境变量配置

## 部署方式

1. **Vercel**: 推荐的部署平台
2. **Netlify**: 推荐的部署平台
3. **Cloudflare Pages**: 推荐的部署平台
4. **自有部署**: 使用Docker或Node.js

## 开发流程

1. 安装依赖：
   ```bash
   npm install
   ```

2. 启动开发服务器：
   ```bash
   npm run dev
   ```
   访问地址：http://localhost:3000

## 构建与测试

### 开发环境搭建

1. 安装依赖：
   ```bash
   npm install
   ```

### 本地开发测试

1. 启动开发服务器：
   ```bash
   npm run dev
   ```
   访问地址：http://localhost:3000

### 构建测试

1. 基础构建：
   ```bash
   npm run build
   ```

2. 启动生产服务器：
   ```bash
   npm run start
   ```

### Claude Code 构建验证指南

每次修改代码后，必须执行以下测试步骤确保项目正常运行：

1. **代码质量检查**：
   ```bash
   npm run lint
   ```
   验证：确保所有TypeScript文件通过ESLint检查，无严重错误

2. **本地构建测试**：
   ```bash
   npm run build
   ```
   验证：检查构建过程无错误，输出文件生成正确

3. **启动本地服务器验证构建结果**：
   ```bash
   npm run start
   ```
   验证：访问 http://localhost:3000 确认页面正常加载

4. **检查控制台是否有错误**：
   - 打开浏览器开发者工具
   - 检查Console面板是否有错误信息
   - 检查Network面板资源是否正常加载

5. **功能验证**：
   - 验证各主题页面是否正常显示
   - 验证导航功能是否正常
   - 验证搜索功能是否正常
   - 验证移动端适配是否正常

## 更新与维护

### 项目更新

定期更新项目依赖以确保安全性：
```bash
npm update
```

## Claude Code 界面设计指南

### 设计原则

1. **简洁清晰**：避免过多装饰，保持界面干净，减少用户认知负荷
2. **一致性**：全局统一的颜色方案、字体、间距和组件样式
3. **层次分明**：通过大小、颜色、留白区分内容优先级，引导用户视线
4. **响应式优先**：确保在所有设备上都有良好的用户体验

### 技术规范

#### CSS框架
项目使用Tailwind CSS实现快速响应式布局

#### 响应式设计

##### 断点规范
- 移动端：默认样式（基础）
- 平板：`@media (min-width: 768px)`
- 桌面：`@media (min-width: 1024px)`
- 大屏：`@media (min-width: 1440px)`

##### 单位使用
- 字体大小：使用`rem`单位确保可访问性
- 间距：使用Tailwind的间距比例系统
- 容器宽度：使用百分比或`vw`单位

### UX最佳实践

#### 交互设计
- 按钮最小点击区域：44×44px
- 导航深度：不超过3级
- 反馈机制：提供即时的操作反馈
- 表单设计：清晰的标签和错误提示

#### 内容呈现
- 图片响应式：`max-width: 100%`
- 文本可读性：每行70-90字符
- 视觉层次：合理使用留白和对比

### Claude Code 提示词模板

#### 新增功能提示词
```
请为项目添加[功能描述]，要求：
1. 遵循现有设计风格和代码规范
2. 确保响应式兼容性（移动端/平板/桌面）
3. 添加必要的TypeScript类型定义
4. 集成到现有路由和状态管理系统
5. 提供构建验证说明
```

#### 代码优化提示词
```
请优化[具体组件/功能]的实现：
1. 提升性能和可维护性
2. 保持现有UI一致性
3. 确保TypeScript类型安全
4. 添加适当的错误处理
5. 验证构建和运行无误
```

#### Bug修复提示词
```
请修复[问题描述]：
1. 准确定位问题根源
2. 提供最小化的修复方案
3. 确保不引入新的问题
4. 添加回归测试验证
5. 说明验证方法
```

### Claude Code 工作流程

1. **需求理解**：仔细分析用户请求，必要时提出澄清问题
2. **影响评估**：分析变更对现有功能的影响范围
3. **方案设计**：制定实现计划，考虑最佳实践
4. **编码实现**：编写高质量、符合规范的代码
5. **验证测试**：确保构建成功且功能正常
6. **文档更新**：必要时更新相关文档

## 开发进度

### 已完成
- 项目初始化
- 核心功能迁移
- 功能测试
- GitHub 仓库创建和代码推送
- 后台管理系统迁移
- 用户认证系统实现
- 权限控制系统实现

### 质量保证

每次代码变更都应：
1. 通过构建测试 (`npm run build`)
2. 验证核心功能正常运行
3. 检查控制台无错误信息
4. 确认响应式设计在各设备上正常
5. 遵循项目现有代码风格